{% extends 'base.html.twig' %}

{% block title %}Post index
{% endblock %}

{% block body %}

	{# RAJOUTER DES IMAGES #}
	<div class="jumbotron-img jumbotron jumbotron-fluid"></div>

	{# CARTE #}
	<div class="row">
		<div class="col-md-6" id="map" style="height:450px; margin-left: 300px"></div>
	</div>


	{# BARRE DE RECHERCHE #}

	<div class="container">
		{% include "search/_searchBar.html.twig" %}

		<h1>Post index</h1>
		<p>
			<i class="fa fa-magic magic-wand"></i>Il y a actuellement

			<strong>
				{{posts|length}}
				posts</strong>


		</p>

		{# AFFICHAGE DES POSTS #}

		<table class="table">

			<thead>
				<tr>
					<th>Image</th>
					<th>Name</th>

					<th>Description</th>
					<th>Adress</th>
					<th>Ville</th>
					<th>Pays</th>
					<th>CreatedAt</th>
					<th>UpdatedAt</th>
					<th>actions</th>
				</tr>
			</thead>
			<tbody>
				{% for post in posts %}
					<tr>
						<td>
							<img class="{{ post.name }}" src="{{ uploaded_asset(post.imagePath) }}" height="300">
						</td>
						<td>{{ post.name }}</td>

						<td>{{ post.description }}</td>
						<td>{{ post.adress }}</td>
						<td>{{ post.ville }}</td>
						<td>{{ post.pays }}</td>
						<td>{{ post.createdAt ? post.createdAt|date('Y-m-d H:i:s') : '' }}</td>
						<td>{{ post.updatedAt ? post.updatedAt|date('Y-m-d H:i:s') : '' }}</td>
						<td>
							<a href="{{ path('post_show', {'id': post.id}) }}">show</a>
							<a href="{{ path('post_edit', {'id': post.id}) }}">edit</a>
						</td>
					</tr>
				{% else %}
					<tr>
						<td colspan="11">no records found</td>
					</tr>
				{% endfor %}
			</tbody>
		</table>
		<a href="{{ path('post_new') }}">Create new</a>

	</div>

{% endblock %}
{# AFFICHAGE CARTE #}
{% block customjs %}
	<script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>
	<script type="text/javascript">
		// On initialise la latitude et la longitude de Paris (centre de la carte)
var lat = 48.852969;
var lon = 2.349903;
var macarte = null;
// Fonction d'initialisation de la carte
function initMap() { // Créer l'objet "macarte" et l'insèrer dans l'élément HTML qui a l'ID "map"
macarte = L.map('map').setView([
lat, lon
], 11);
// Leaflet ne récupère pas les cartes (tiles) sur un serveur par défaut. Nous devons lui préciser où nous souhaitons les récupérer. Ici, openstreetmap.fr
L.tileLayer('https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png', { // Il est toujours bien de laisser le lien vers la source des données
attribution: 'données © <a href="//osm.org/copyright">OpenStreetMap</a>/ODbL - rendu <a href="//openstreetmap.fr">OSM France</a>',
minZoom: 1,
maxZoom: 20
}).addTo(macarte);
}
window.onload = function () { // Fonction d'initialisation qui s'exécute lorsque le DOM est chargé
initMap();
};
	</script>

{% endblock %}
